<!-- <ion-menu contentId="reportContent" side="end" type="overlay" menuId="reportDetails" (ionDidClose)="menuOpened = false;"
  style="--width: 400px">
  <ion-header style="background-color:#43425d; color: #fcfcfc;">
    <!-- <img style="margin: 17px;width: 22px;height: 17px;float:left" src="assets/icon/dashboard/icon All Holidays@3x.png"> --
    <p style="line-height: 1.27;font-size: 11px;color: #fcfcfc;font-weight: bold;margin: 20px;">
      DOWNLOADED REPORTS
    </p>
  </ion-header>

  <ion-content>
    <div class="menuContent">
      <div
        style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;padding-left: 15px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
        <ion-row>
          <ion-col size="10" style="font-size: 12px;white-space: nowrap;
                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
            INDIVIDUAL REPORTS</ion-col>
        </ion-row>
      </div>
      <div>
        <ion-item class="ionItem" lines="none">
          <ion-label class="checkLabel">Select All</ion-label>
          <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [(ngModel)]="isMain" [indeterminate]="isInde"
            (click)="checkLeaveTypes()">
          </ion-checkbox>
        </ion-item>
        <ion-list lines="none" style="padding-top: 0;padding-bottom: 0;" *ngFor="let item of leaveTypes">
          <ion-item class="ionItem">
            <ion-label class="checkLabel">{{item.CODE}}</ion-label>
            <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [(ngModel)]="item.isChecked"
              (ionChange)="checkSubLeaveTypes(item.LEAVE_TYPE_GUID)">
            </ion-checkbox>
          </ion-item>
        </ion-list>
      </div>

      <div
        style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;padding-left: 15px;margin-bottom: 5px;margin-top:5px;color: #a3a6b4;font-weight: bold;">
        <ion-row>
          <ion-col size="10" style="font-size: 12px;white-space: nowrap;
                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
            GROUP REPORTS</ion-col>
        </ion-row>
      </div>
    </div>

    <div style="text-align: center;">
      <ion-button fill="outline"
        style="--border-radius: 2px;background: #f5f6fa;height: 30px; width: 150px;font-size: 11px;text-transform: none">
        Clear
      </ion-button>
      <ion-button
        style="--border-radius: 2px;font-size: 11px;height: 30px;width:210px;cursor: pointer;text-transform: none;"
        color="primary">
        Download
      </ion-button>
    </div>
  </ion-content>
</ion-menu>
<ion-router-outlet id="reportContent">
</ion-router-outlet> -->

<ion-card>
  <ion-card-header style="border-radius: 2px;box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.04);">
    <div class="fullContainer">
      <div style="display: flex; width: auto; ">
        <div class="left" style="min-width: fit-content;">
          <img src="assets/icon/leave_setup/icon_report@3x.png" style="width:37px;height:31px">
        </div>
        <div class="right">
          <ion-card-subtitle style="color: #43425d;opacity: 0.8;font-weight: bold;font-size: 13px;">Reports
          </ion-card-subtitle>
          <ion-card-subtitle class="subtitle" style="font-size: 12px;">
            Produce reports for individual and group. Simply select report & leave types, then proceed with selected
            employees
          </ion-card-subtitle>
        </div>
      </div>

      <div style="margin-right: 33px; margin-left: auto; padding-left: 5px; line-height: initial;">
        <mat-form-field class="group" appearance="outline" *ngIf="groupKey && showGroupSelection"
          [style.visibility]="clickedProduce==true? 'visible': 'collapse'"
          style="font-size: 12px;width: 200px;color: #43425d;margin-right: 20px;">
          <mat-label>{{name}}</mat-label>
          <mat-select [(value)]="selectedName">
            <mat-option *ngFor=" let key of groupKey;let i = index" [value]="key"
              (click)="arrayDetails = groupValue[i];">
              {{key}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <ion-button [class]="'hide-sm-down'"
          style="margin-top: -5px;--border-radius: 2px;font-size: 11px;width:180px;cursor: pointer;text-transform: none;"
          color="primary" [style.visibility]="clickedProduce==true? 'visible': 'collapse'"
          [style.height]="clickedProduce==true? '35px': '0px'" (click)="clickedProduce=false;showGroupSelection = true">
          Back To Main
        </ion-button>
        <ion-button [class]="'hide-sm-up'"
          style="margin-top: -5px;--border-radius: 2px;font-size: 11px;height: 35px;width:180px;cursor: pointer;text-transform: none;"
          color="primary" [style.visibility]="clickedProduce==true? 'visible': 'collapse'"
          (click)="clickedProduce=false;showGroupSelection = true">
          Back To Main
        </ion-button>
        <!-- <ion-button
          style="--border-radius: 2px;font-size: 11px;height: 30px;width:180px;cursor: pointer;text-transform: none;"
          color="primary"
          (click)="reportAPI.menu.open('reportDetails');reportAPI.menu.enable(true, 'reportDetails');menuOpened = true;">
          Downloaded Reports
        </ion-button> -->
      </div>
    </div>
  </ion-card-header>
  <div style="background: #f0f0f7;height: 100%;position: absolute;width: 100%;">
    <div class="cardContent">

      <!-- main page -->
      <ion-card-content style="max-height: 100%; overflow-y: auto;" [style.display]="clickedProduce==true? 'none': ''">
        <div style="display: flex; flex-wrap: wrap">
          <div class="dateForm">
            <mat-form-field class="date" style="padding: 2px; flex:1; min-width: 150px;" appearance="outline">
              <mat-label>Start date</mat-label>
              <input class="dateInput" matInput [matDatepicker]="picker1" [formControl]="firstPicker" required>
              <div class="calendar-icon" [inlineSVG]="'assets/icon/option/calendar.svg'" (click)="picker1.open()">
              </div>
              <mat-datepicker #picker1></mat-datepicker>
            </mat-form-field>
            <mat-form-field class="date" style="padding: 2px; flex:1; min-width: 150px;" appearance="outline">
              <mat-label>End date</mat-label>
              <input class="dateInput" matInput [matDatepicker]="picker2" [formControl]="secondPicker" required>
              <div class="calendar-icon" [inlineSVG]="'assets/icon/option/calendar.svg'" (click)="picker2.open()">
              </div>
              <mat-datepicker #picker2></mat-datepicker>
            </mat-form-field>
          </div>
        </div>
        <div class="row">
          <div class="report">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col size="10" style="font-size: 12px;white-space: nowrap;
                            text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  REPORT TYPES</ion-col>
              </ion-row>
              <mat-form-field appearance="outline"
                style="height: 55px;font-size: 12px;width: 100%;color: #43425d;opacity: 0.8;">
                <mat-select [(value)]="selects" placeholder="Nothing Selected">
                  <mat-option value="leave-entitlement">Leave Entitlement Summary</mat-option>
                  <mat-option value="approval-override">Approval Override History</mat-option>
                  <mat-option value="apply-on-behalf">Apply On Behalf History</mat-option>
                  <!-- <mat-option value="entitlement-claim">Entitlement Claim History</mat-option> -->
                  <mat-option value="leave-taken">Leave Taken History</mat-option>
                  <mat-option value="leave-adjustment">Leave Adjustment History</mat-option>
                  <mat-option value="leave-cancellation">Leave Cancellation History</mat-option>
                  <mat-option value="leave-rejected">Leave Rejected History</mat-option>
                  <mat-option value="leave-forfeited">Forfeited Leave History</mat-option>
                  <mat-option value="employee-master-list">Employee Master List</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col size="10" style="font-size: 12px;white-space: nowrap;
                          text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  LEAVE TYPES</ion-col>
              </ion-row>
            </div>
            <div style="overflow-y: auto;height: calc(100% - 13em)">
              <ion-item class="ionItem" lines="none">
                <ion-label class="checkLabel">Select All</ion-label>
                <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [(ngModel)]="isMain" [indeterminate]="isInde"
                  (click)="checkLeaveTypes()">
                </ion-checkbox>
              </ion-item>
              <ion-list lines="none" style="padding-top: 0;padding-bottom: 0; background: transparent;"
                *ngFor="let item of leaveTypes">
                <ion-item class="ionItem">
                  <ion-label class="checkLabel">{{item.CODE}}</ion-label>
                  <ion-checkbox class="ionCheckbox" slot="start" mode="ios" [(ngModel)]="item.isChecked"
                    (ionChange)="checkSubLeaveTypes()">
                  </ion-checkbox>
                </ion-item>
              </ion-list>
            </div>
          </div>
          <div class="listEmployee">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 15px;color: #a5a4bf;">
              <ion-row>
                <ion-col style="font-weight: bold;white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;flex: 1 1 30px;
    min-width: 200px;">
                  EMPLOYEE LIST
                  <ion-searchbar mode="md" class="searchbar" placeholder="Search by Employee Name or ID"
                    (ionChange)="keyUpSearchbar($event.srcElement.value)">
                  </ion-searchbar>
                </ion-col>
                <ion-col style="flex: 1 1 30px; min-width: 200px;">
                  <p style="font-size: 12px;color: #43425d;">
                    Company:</p>
                  <mat-form-field appearance="outline"
                    style="height: 50px;font-size: 12px;width: 90%;color:#43425d;opacity: 0.8;">
                    <mat-select [(value)]="companyValue">
                      <mat-option value="Nothing Selected" (click)="companyId = null;userNameList()">
                        Nothing Selected
                      </mat-option>
                      <mat-option *ngFor="let company of companyList" [value]="company.TENANT_COMPANY_GUID"
                        (click)="selectedCompany(company.TENANT_COMPANY_GUID)">
                        {{company.NAME}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ion-col>
                <!-- <ion-col style="flex: 1 1 30px; min-width: 200px;"></ion-col> -->
                <!-- <ion-col style="flex: 1 1 30px; min-width: 200px;"></ion-col> -->
              </ion-row>
              <!-- <ion-row style="display: flex;  flex-wrap: wrap;">
                <ion-searchbar mode="md" class="searchbar" placeholder="Search by Employee Name or ID"
                  (ionChange)="keyUpSearchbar($event.srcElement.value)">
                <!-- </ion-searchbar>
                <ion-searchbar mode="md" class="searchbar" placeholder="Search by Name or ID"
                  (ionChange)="keyUpSearchbar($event.srcElement.value)">
                </ion-searchbar> -->
              <!-- </div>
                <div [class]="'hide-sm-up'">
                  <ion-searchbar mode="md" class="searchbar" placeholder="Search by Name or ID"
                    (ionChange)="keyUpSearchbar($event.srcElement.value)">
                  </ion-searchbar>
                </div> --
              </ion-row> -->
              <ion-row style="display: flex;  flex-wrap: wrap;">
                <ion-col style="flex: 1 1 30px; min-width: 200px;">
                  <p style="font-size: 12px;color: #43425d;">
                    Department:</p>
                  <mat-form-field appearance="outline"
                    style="height: 50px;font-size: 12px;width: 90%;color:#43425d;opacity: 0.8;">
                    <mat-select [(value)]="departmentValue">
                      <mat-option value="Nothing Selected" (click)="departmentName=null;userNameList()">Nothing
                        Selected</mat-option>
                      <mat-option *ngFor=" let department of departmentList" [value]="department.department"
                        (click)="departmentName = department.department;userNameList();">
                        {{department.department}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ion-col>
                <ion-col style="flex: 1 1 30px; min-width: 200px;">
                  <p style="font-size: 12px;color: #43425d;">
                    Branch:</p>
                  <mat-form-field appearance="outline"
                    style="height: 50px;font-size: 12px;width: 90%;color:#43425d;opacity: 0.8;">
                    <mat-select [(value)]="branchValue">
                      <mat-option value="Nothing Selected" (click)="branchName=null;userNameList()">Nothing
                        Selected</mat-option>
                      <mat-option *ngFor="let branch of branchList" [value]="branch.BRANCH"
                        (click)="branchName = branch.BRANCH;userNameList();">
                        {{branch.BRANCH}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ion-col>
                <ion-col style="flex: 1 1 30px; min-width: 200px;">
                  <p style="font-size: 12px;color: #43425d;">
                    Cost Centre:</p>
                  <mat-form-field appearance="outline"
                    style="height: 50px;font-size: 12px;width: 90%;color:#43425d;opacity: 0.8;">
                    <mat-select [(value)]="costCentreValue">
                      <mat-option value="Nothing Selected" (click)="costCentreName=null;userNameList()">Nothing
                        Selected
                      </mat-option>
                      <mat-option *ngFor="let item of costcentre" [value]="item.COSTCENTRE"
                        (click)="costCentreName = item.COSTCENTRE;userNameList();">
                        {{item.COSTCENTRE}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ion-col>
                <ion-col style="flex: 1 1 30px; min-width: 200px;"></ion-col>
                <ion-col style="flex: 1 1 30px; min-width: 200px;"></ion-col>
              </ion-row>
              <ion-row>
                <ion-col size="1.5"
                  style="text-align: center;padding-left: 10px;padding-right: 30px;text-overflow: initial;">
                  <ion-checkbox mode="ios" class="ionCheckboxList" style="margin-top: 6px;" [(ngModel)]="listMain"
                    [indeterminate]="indeterminate" (click)="headerList()">
                  </ion-checkbox>
                </ion-col>
                <ion-col size="1" align-self-center [class]="'hide-md-down'" style="white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;min-width: 50px;">
                  ID
                </ion-col>
                <ion-col size="4" align-self-center [class]="'hide-sm-down'" style="white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;">
                  EMPLOYEE NAME
                </ion-col>
                <ion-col align-self-center [class]="'hide-md-down'" style="white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;">
                  DESIGNATION
                </ion-col>
                <ion-col align-self-center [class]="'hide-md-down'" style="white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;">
                  DEPARTMENT
                </ion-col>
                <ion-col align-self-center [class]="'hide-md-up'" style="white-space: nowrap;
                  text-overflow: ellipsis;overflow: hidden;">
                  EMPLOYEE DETAILS
                </ion-col>
              </ion-row>
            </div>

            <div style="overflow: auto;min-height: 250px;height: calc( 100% - 15.5em);" *ngIf="!filterSpinner">
              <ng-container *ngIf="!filterSpinner">
                <ion-row class="detailsRow" style="font-size: 12px;" *ngFor="let item of userList; let i=index">
                  <ion-col size="1.5" align-self-center style="text-align: center;padding-right: 30px;"
                    *ngIf="(this.reportPlatform.platforms().includes('desktop'))">
                    <ng-container *ngIf="url">
                      <ng-container *ngFor="let list of url.details; let j= index">
                        <ng-container *ngIf="url.details[j].USER_GUID == item.userId">
                          <ion-avatar class="avatar" (mouseover)="hoverValue(i, true, item.isChecked)"
                            (mouseout)="hoverValue(i, false, item.isChecked)"
                            *ngIf="url.details[j].PROFILE_PICTURE !== null">
                            <img src="{{url.link + url.details[j].PROFILE_PICTURE}}" style="margin-left: 5px;"
                              [style.display]="hideImg[i] ? 'none' : 'block'">
                            <div class="checkboxOnAvatar" [style.display]="hideImg[i] ? 'block' : 'none'">
                              <ion-checkbox mode="ios" class="ionCheckboxList"
                                style="position: absolute;margin-top: 7px;margin-left: -4px;"
                                [(ngModel)]="item.isChecked" (ionChange)="contentList(item.id)">
                              </ion-checkbox>
                            </div>
                          </ion-avatar>
                          <ion-avatar class="avatar" (mouseover)="hoverValue(i, true, item.isChecked)"
                            (mouseout)="hoverValue(i, false, item.isChecked)"
                            *ngIf="url.details[j].PROFILE_PICTURE === null">
                            <img src="assets/icon/picture.png" style="margin-left: 5px;"
                              [style.display]="hideImg[i] ? 'none' : 'block'">
                            <div class="checkboxOnAvatar" [style.display]="hideImg[i] ? 'block' : 'none'">
                              <ion-checkbox mode="ios" class="ionCheckboxList"
                                style="position: absolute;margin-top: 7px;margin-left: -4px;"
                                [(ngModel)]="item.isChecked" (ionChange)="contentList(item.id)">
                              </ion-checkbox>
                            </div>
                          </ion-avatar>
                        </ng-container>
                      </ng-container>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1.5" align-self-center style="text-align: center;padding-right: 30px;"
                    *ngIf="!(this.reportPlatform.platforms().includes('desktop'))">
                    <ion-avatar class="avatar" (mouseover)="hoverValue(i, true, item.isChecked)"
                      (mouseout)="hoverValue(i, false, item.isChecked)">
                      <div class="checkboxOnAvatar" style="display: block;">
                        <ion-checkbox mode="ios" class="ionCheckboxList"
                          style="position: absolute;margin-top: 7px;margin-left: -4px;" [(ngModel)]="item.isChecked"
                          (ionChange)="contentList(item.id)">
                        </ion-checkbox>
                      </div>
                    </ion-avatar>
                  </ion-col>
                  <ion-col size="1" align-self-center [class]="'hide-md-down'" style="color: #808495; font-size: 12px;white-space: pre-line;overflow: hidden;text-overflow:
                    ellipsis;min-width: 50px;">
                    {{item.staffNumber}}
                  </ion-col>
                  <ion-col size="4" align-self-center [class]="'hide-sm-down'" style="white-space: pre-line;overflow: hidden;text-overflow: ellipsis;font-weight: bold;color:
                    #43425d;opacity: 0.8;">
                    <div>{{item.employeeName}}</div>
                    <div [class]="'hide-md-up'"
                      style="color: rgb(128, 132, 149); font-size: 11px; white-space: pre-line;font-weight: normal;">
                      ID: {{item.staffNumber}}
                    </div>
                  </ion-col>
                  <ion-col align-self-center [class]="'hide-md-up'" style="color: #808495; font-size: 11px;white-space: pre-line;overflow: hidden;text-overflow:
                    ellipsis; padding-left: 15px;">
                    <ion-item-group [class]="'hide-sm-up'" style="margin-bottom: 5px;">
                      <div style="font-weight: bold;color:
                    #43425d;opacity: 0.8;font-size: 12px;margin-bottom: 3px;">{{item.employeeName}}</div>
                      <div>
                        <div style="font-weight: bold; line-height: normal;">ID</div>
                        {{item.staffNumber}}
                      </div>
                    </ion-item-group>
                    <ion-item-group style="margin-bottom: 5px;">
                      <div style="font-weight: bold; line-height: normal;">DESIGNATION</div>
                      {{item.designation}}
                    </ion-item-group>
                    <ion-item-group>
                      <div style="font-weight: bold; line-height: normal;">DEPARTMENT</div>
                      {{item.department}}
                    </ion-item-group>
                  </ion-col>
                  <ion-col align-self-center [class]="'hide-md-down'" style="color: #808495; font-size: 11px;white-space: pre-line;overflow: hidden;text-overflow:
                    ellipsis;">
                    {{item.designation}}
                  </ion-col>
                  <ion-col align-self-center [class]="'hide-md-down'" style="color: #808495; font-size: 11px;white-space: pre-line;overflow: hidden;text-overflow:
                    ellipsis;">
                    {{item.department}}
                  </ion-col>
                  <ion-item lines="full" style=" --min-height: none;width: 100%;padding-top: 1%;
                    padding-bottom: 1%;"></ion-item>
                </ion-row>
              </ng-container>
              <div *ngIf="userList && userList.length === 0 && !filterSpinner"
                style="width: 100%; text-align:center;padding: 10px">
                <div class="search-icon" [inlineSVG]="'assets/icon/top_header/search.svg'"></div>
                <p style="font-size: 20px;color:#a3a6b4;opacity: 0.8;padding-top:10px ">No Results Found
                </p>
              </div>
            </div>
            <div style="overflow: auto;min-height: 250px;height: calc( 100% - 20em);" *ngIf="filterSpinner">
              <div style="width: 100%; height:100%; text-align: center; margin-top: -30px">
                <app-spinner></app-spinner>
              </div>
            </div>
            <div class="buttons" style="display: flex; flex-wrap: wrap;justify-content: flex-end;">
              <div [class]="'hide-sm-down'"
                style="flex:1.5; min-width: 0px;font-size: 12px;color: #43425d;opacity: 0.8;padding-top: 10px;">
                <strong>Selected User No.:
                </strong>{{selectedNum}}</div>
              <ion-button fill="outline"
                (click)="selects= null;clearCheckbox();companyValue = 'Nothing Selected'; departmentValue = 'Nothing Selected'; branchValue= 'Nothing Selected';costCentreValue= 'Nothing Selected';companyId=null;departmentName=null;branchName=null;costCentreName=null;"
                style="--border-radius: 2px;background: #f5f6fa;height: 30px; width: 190px;font-size:
                11px;text-transform: none; flex: 1;min-width: 150px;">
                Clear
              </ion-button>
              <ion-button style="--border-radius: 2px;font-size: 11px;height: 30px;width:320px;cursor: pointer;text-transform:
                none;flex:2; min-width: 180px;" color="primary"
                [disabled]="selects == null || selectedUserId.length == 0" [matMenuTriggerFor]="menu">
                Produce Report
                <ion-spinner name="lines-small" *ngIf="showSpinner" color="primary" style="position: absolute;
                margin-left: 60px;color: white;"></ion-spinner>
                <mat-icon style="position: absolute;right: 0;margin-right: 20px;">arrow_drop_down</mat-icon>
              </ion-button>
              <mat-menu #menu="matMenu" yPosition="above" xPosition="after">
                <button mat-menu-item [matMenuTriggerFor]="group" style="outline: none;font-size: 12px;
                color: #43425d;">Group By</button>
              </mat-menu>
              <mat-menu #group="matMenu">
                <button mat-menu-item style="outline: none;font-size: 12px;
                color: #43425d;" (click)="produceGroupReport('companyName', 'Company')">Company</button>
                <button mat-menu-item style="outline: none;font-size: 12px;
                color: #43425d;" (click)="produceGroupReport('department', 'Department')">Department</button>
                <button mat-menu-item style="outline: none;font-size: 12px;
                color: #43425d;" (click)="produceGroupReport('branch', 'Branch')">Branch</button>
                <button mat-menu-item style="outline: none;font-size: 12px;
                color: #43425d;" (click)="produceGroupReport('costcentre', 'Cost Centre')">Cost
                  Centre</button>
                <button mat-menu-item style="outline: none;font-size: 12px;
                color: #43425d;" (click)="produceGroupReport('all', 'All'); showGroupSelection = false">No
                  grouping</button>
              </mat-menu>
            </div>
          </div>
        </div>
      </ion-card-content>

      <!-- leave entitlement summary -->
      <ion-card-content *ngIf="selects == 'leave-entitlement' && clickedProduce==true"
        style=" max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: fit-content;">
            <mat-form-field appearance="outline" id="saveas"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Leave Entitlement Summary', [{ header: 'No', dataKey: 'no' }, { header: 'Employee No', dataKey: 'employeeNo' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Length of Service (Years)', dataKey: 'yearService' }, { header: 'Leave Type', dataKey: 'leaveType' }, { header: 'Entitlement (Days)', dataKey: 'entitledDays' }, { header: 'Carried Forward (Days)', dataKey: 'carriedForward' }, { header: 'Forfeited (Days)', dataKey: 'forfeited' }, { header: 'Taken (Days)', dataKey: 'taken' }, { header: 'Pending (Days)', dataKey: 'pending' }, { header: 'Balance (Days)', dataKey: 'balance' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Leave Entitlement Summary',['employeeNo', 'employeeName', 'yearService', 'leaveDetail.leaveTypeName', 'leaveDetail.entitledDays', 'leaveDetail.carriedForward', 'leaveDetail.forfeited', 'leaveDetail.taken', 'leaveDetail.pending', 'leaveDetail.balance']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Leave Entitlement Summary - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                From <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.3" class="titleRow"
                style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1" class="titleRow"
                style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 83px;">
                Employee No</ion-col>
              <ion-col size="2" class="titleRow"
                style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.2" class="titleRow"
                style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 105px;">
                Length of Service (Years)</ion-col>
              <ion-col size="1.5" class="titleRow"
                style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow"
                style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 88px;">
                Entitlement (Days)</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 95px;">
                Carried Forward (Days)</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Forfeited (Days)</ion-col>
              <ion-col size="1" class="titleRow"
                style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;min-width: 88px;">
                Taken (Days)</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Pending (Days)</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Balance (Days)</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: fit-content;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.3" class="titleRow text" style="min-width: 26px;white-space: pre-line;">{{i + 1}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 83px;white-space: pre-line;">
                    {{item.employeeNo}}</ion-col>
                  <ion-col size="2" class="text" style="text-align: left;white-space: pre-line;min-width: 175px;">
                    {{item.employeeName}}
                  </ion-col>
                  <ion-col size="1.2" class="titleRow text" style="min-width: 105px;white-space: pre-line;">
                    {{item.yearService}}</ion-col>
                  <ion-col size="1.5" style=" text-align: left;min-width: 132px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.leaveTypeName}}
                      </p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 88px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.entitledDays}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 95px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.carriedForward}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 88px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.forfeited}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 88px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.taken}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 88px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.pending}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width: 88px;white-space: pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.balance}}</p>
                    </ng-container>
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- approval override history-->
      <ion-card-content *ngIf="selects == 'approval-override' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: fit-content;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Approval Override History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee No', dataKey: 'employeeNo' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'Application Date', dataKey: 'applicationDate' }, { header: 'Overriden By', dataKey: 'overrideBy' }, { header: 'Overriden Date', dataKey: 'overrideDate' }, { header: 'Start Date', dataKey: 'startDate' }, { header: 'End Date', dataKey: 'endDate' }, { header: 'No Of Days', dataKey: 'noOfDays' }, { header: 'Status', dataKey: 'status' }, { header: 'Remarks', dataKey: 'remarks' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Approval Override History',['employeeNo', 'employeeName', 'leaveTypeName', 'applicationDate', 'overrideBy', 'overrideDate', 'startDate', 'endDate', 'noOfDays', 'status']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Approval Override History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Application Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;;min-width: 1300px;">
              <ion-col size="0.4" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.3" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Application Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                Overriden By</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                Overriden Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                End Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                No of Days</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px">
                Status</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px">
                Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: fit-content;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;min-width: 1300px;">
                  <ion-col size="0.4" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px;white-space: pre-line;">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1.3" class="text" style="white-space: pre-line; min-width: 132px;">
                    {{item.leaveTypeName}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.applicationDate | date:'yyyy-MM-dd'}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.overrideBy }}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.overrideDate | date:'yyyy-MM-dd'}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.startDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.endDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.noOfDays}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="white-space: pre-line; min-width: 88px;">
                    {{item.status | titlecase}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="white-space: pre-line; min-width: 175px;">
                    {{item.remarks}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Apply on Behalf History -->
      <ion-card-content *ngIf="selects == 'apply-on-behalf' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Apply On Behalf History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Length of Service (Years)', dataKey: 'yearService' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'Application Date', dataKey: 'applicationDate' }, { header: 'Date Confirmed', dataKey: 'confirmedDate' }, { header: 'Applied By', dataKey: 'appliedBy' }, { header: 'Start Date', dataKey: 'startDate' }, { header: 'End Date', dataKey: 'endDate' }, { header: 'No Of Days', dataKey: 'noOfDays' }, { header: 'Status', dataKey: 'status' }, { header: 'Remarks', dataKey: 'remarks' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Apply On Behalf History',['employeeName', 'yearService', 'leaveTypeName', 'applicationDate', 'confirmedDate', 'appliedBy', 'startDate', 'endDate', 'noOfDays', 'status', 'remarks']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Apply On Behalf History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Application Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.4" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.3" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 105px;">
                Length of Service (Years)</ion-col>
              <ion-col size="1" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
            min-width: 88px;">
                Application Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
            min-width: 88px;">
                Date Confirmed</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
            min-width: 88px;">
                Applied By</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
            min-width: 88px;">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
                min-width: 88px;">
                End Date</ion-col>
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
            min-width: 88px;">
                No of Days</ion-col>
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Status</ion-col>
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
              min-width: 88px;">
                Remarks</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;
              min-width: 88px;">
                Attachment</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: fit-content;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.4" class="titleRow text">
                    {{i+1}}</ion-col>
                  <ion-col size="1.3" class="text">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 105px;white-space: pre-line;">
                    {{item.yearService}}</ion-col>
                  <ion-col size="1" class="text" style="min-width: 132px;white-space: pre-line;">
                    {{item.leaveTypeName}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.applicationDate | date:'yyyy-MM-dd'}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.confirmedDate | date:'yyyy-MM-dd'}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.appliedBy}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.startDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.endDate}}</ion-col>
                  <ion-col size="0.5" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.noOfDays}}</ion-col>
                  <ion-col size="0.5" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.status | titlecase}}</ion-col>
                  <ion-col size="0.5" class="titleRow text" style="min-width: 88px;white-space: pre-line;">
                    {{item.remarks}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px;white-space: pre-line;"
                    *ngIf="item.attachment != null">
                    <a style="color: #7069d8;display: block;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;"
                      [href]="item.link+item.attachment" download>{{item.attachment}}</a>
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Entitlement Claim History -->
      <ion-card-content *ngIf="selects == 'entitlement-claim' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF" (click)="savePDF()">
                  PDF
                </mat-option>
                <mat-option value="CSV">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Entitlement Claim History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                From <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Application Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                End Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                No of Days</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Status</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 88px;">
                Request Remarks</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
               -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
               5px;min-width: 88px;">
                Final Approval Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1300px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap; min-width: 1300px;">
                  <ion-col size="0.5" class="titleRow text">
                    {{i+1}}</ion-col>
                  <ion-col size="2" class="text">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1" class="text" style="min-width: 132px; white-space: pre-line;">
                    {{item.leaveTypeName}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.applyDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.startDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.endDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.noOfDays}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.status}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.requestRemarks}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.finalApproveRemarks}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Leave Taken History -->
      <ion-card-content *ngIf="selects == 'leave-taken' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: 1300px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Leave Taken History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee No', dataKey: 'employeeNo' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveType' }, { header: 'Start Date', dataKey: 'startDate' }, { header: 'End Date', dataKey: 'endDate' }, { header: 'No Of Days', dataKey: 'noOfDays' }, { header: 'Approved By', dataKey: 'approveBy' }, { header: 'Remarks', dataKey: 'remarks' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Leave Taken History',['employeeNo', 'employeeName', 'leaveDetail.leaveTypeName', 'leaveDetail.startDate', 'leaveDetail.endDate', 'leaveDetail.noOfDays', 'leaveDetail.approveBy', 'leaveDetail.remarks']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Leave Taken History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Start Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap; min-width: 1300px;">
              <ion-col size="0.3" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                End Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                No of Days</ion-col>
              <ion-col size="2" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Approved By</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1300px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.3" class="titleRow text" style="min-width:26px;">
                    {{i + 1}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width:175px; white-space:pre-line;">
                    {{item.employeeNo}}</ion-col>
                  <ion-col size="2" class="text" style="min-width:175px; white-space:pre-line;">
                    {{item.employeeName}}
                  </ion-col>
                  <ion-col size="1.5" style="min-width:175px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.leaveTypeName}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width:88px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.startDate}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width:88px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.endDate}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1" class="titleRow" style="min-width:88px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.noOfDays}}</p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="2" class="titleRow" style="min-width:175px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text" *ngIf="leaveItems.approveBy !== ''">{{leaveItems.approveBy}}</p>
                      <p class="text" *ngIf="leaveItems.approveBy === ''"><br> </p>
                    </ng-container>
                  </ion-col>
                  <ion-col size="1.5" class="titleRow" style="min-width:175px; white-space:pre-line;">
                    <ng-container *ngFor="let leaveItems of item.leaveDetail">
                      <p class="text">{{leaveItems.remarks}}</p>
                    </ng-container>
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Leave Adjustment History -->
      <ion-card-content *ngIf="selects == 'leave-adjustment' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: 1300px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Leave Adjustment History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee No', dataKey: 'employeeNo' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'Adjustment', dataKey: 'adjustment' }, { header: 'Adjusted By', dataKey: 'adjustBy' }, { header: 'Adjustment Date', dataKey: 'adjustDate' }, { header: 'Remarks', dataKey: 'remarks' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Leave Adjustment History',['employeeNo', 'employeeName', 'leaveTypeName', 'adjustment', 'adjustBy', 'adjustDate', 'remarks']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Leave Adjustment History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Adjustment Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 200px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Adjustment</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Adjusted By</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Adjustment Date</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1300px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails;let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.5" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.employeeNo}}</ion-col>
                  <ion-col size="2" class="text" style="min-width: 200px; white-space: pre-line;">
                    {{item.employeeName}}
                  </ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 132px; white-space: pre-line;">
                    {{item.leaveTypeName}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.adjustment}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.adjustBy}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.adjustDate | date:'yyyy-MM-dd' }}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.remarks}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Leave Cancellation History -->
      <ion-card-content *ngIf="selects == 'leave-cancellation' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: 1300px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Leave Cancellation History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'Start Date', dataKey: 'startDate' }, { header: 'End Date', dataKey: 'endDate' }, { header: 'No Of Days', dataKey: 'noOfDays' }, { header: 'Cancelled By', dataKey: 'cancelBy' }, { header: 'Leave Remarks', dataKey: 'leaveRemarks' }, { header: 'Cancellation Remarks', dataKey: 'cancelRemarks' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Leave Cancellation History',['employeeName', 'leaveTypeName', 'startDate', 'endDate', 'noOfDays', 'cancelBy', 'leaveRemarks', 'cancelRemarks']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Leave Cancellation History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Start Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                End Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                No of Days</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Cancelled By</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Leave Remarks</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Cancellation Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1300px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.5" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="2" class="text" style="min-width: 200px; white-space:pre-line;">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px; white-space:pre-line;">
                    {{item.leaveTypeName}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space:pre-line;">
                    {{item.startDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space:pre-line;">
                    {{item.endDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space:pre-line;">
                    {{item.noOfDays}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space:pre-line;">
                    {{item.cancelBy}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space:pre-line;">
                    {{item.leaveRemarks}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space:pre-line;">
                    {{item.cancelRemarks}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Leave Rejected history -->
      <ion-card-content *ngIf="selects == 'leave-rejected' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;min-width: 1300px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Leave Rejected History', [{ header: 'No', dataKey: 'no' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'Start Date', dataKey: 'startDate' }, { header: 'End Date', dataKey: 'endDate' }, { header: 'No Of Days', dataKey: 'noOfDays' }, { header: 'Rejected By', dataKey: 'rejectBy' }, { header: 'Leave Remarks', dataKey: 'remarks' }, { header: 'Rejection Remarks', dataKey: '' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Leave Rejected History',['employeeName', 'leaveTypeName', 'startDate', 'endDate', 'noOfDays', 'rejectBy', 'remarks']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Leave Rejected History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Start Date: <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 200px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Start Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                End Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                No of Days</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Rejected By</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Leave Remarks</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Rejection Remarks</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1300px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.5" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="2" class="text" style="min-width: 200px; white-space: pre-line;">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px; white-space: pre-line;">
                    {{item.leaveTypeName}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.startDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.endDate}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.noOfDays}}</ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.rejectBy}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.leaveRemarks}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.rejectRemarks}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Forfeited Leave History -->
      <ion-card-content *ngIf="selects == 'leave-forfeited' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div
            style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px 0px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Forfeited Leave History', [{ header: 'No', dataKey: 'no' },{ header: 'Employee No', dataKey: 'employeeNo' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Leave Type', dataKey: 'leaveTypeName' }, { header: 'No. Of Days Forfeited', dataKey: 'noOfDays' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Forfeited Leave History',['employeeNo', 'employeeName', 'leaveTypeName', 'noOfDays']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Forfeited Leave History - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                From <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Employee No</ion-col>
              <ion-col size="2" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 132px;">
                Leave Type</ion-col>
              <ion-col size="1.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                No. Of Days Forfeited</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: fit-content;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.5" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px; white-space: pre-line;">
                    {{item.employeeNo}}</ion-col>
                  <ion-col size="2" class="text" style="min-width: 200px; white-space: pre-line;">
                    {{item.employeeName}}
                  </ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 132px; white-space: pre-line;">
                    {{item.leaveTypeName}}
                  </ion-col>
                  <ion-col size="1.5" class="titleRow text" style="min-width: 175px; white-space: pre-line;">
                    {{item.noOfDays}}</ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>

      <!-- Master -->
      <ion-card-content *ngIf="selects == 'employee-master-list' && clickedProduce==true"
        style="max-height: 100%;height: 100%;padding: 0;">
        <div id="template" style="height: 100%;overflow-x: auto; overflow-y: hidden;">
          <div style="width:100%;background: #43425d;color:white;font-size: 12px;padding: 10px;border-radius: 4px 4px 0px
            0px; min-width: 1500px;">
            <mat-form-field id="saveas" appearance="outline"
              style="font-size: 12px;width: 130px;color: #43425d;float: right;">
              <mat-select placeholder="Save As">
                <mat-option value="PDF"
                  (click)="savePDF('Employee Master List', [{ header: 'No', dataKey: 'no' }, { header: 'Employee Name', dataKey: 'employeeName' }, { header: 'Company Name', dataKey: 'companyName' }, { header: 'Department', dataKey: 'department' }, { header: 'Designation', dataKey: '' }, { header: 'Email', dataKey: 'email' }, { header: 'Approver', dataKey: 'approver' }, { header: 'Joining Date', dataKey: 'joinDate' }, { header: 'Confirmed Date', dataKey: 'confirmDate' }, { header: 'Resigned Date', dataKey: 'resignDate' }, { header: 'Status', dataKey: 'status' }])">
                  PDF
                </mat-option>
                <mat-option value="CSV"
                  (click)="saveCSV('Employee Master List',['employeeName', 'companyName', 'department', 'email', 'approver', 'joinDate', 'confirmDate', 'resignDate', 'status']);">
                  CSV
                </mat-option>
              </mat-select>
            </mat-form-field>
            <ion-row>
              <ion-col style="font-weight: bold;white-space: nowrap; font-size: 14px;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                Employee Master List - {{selectedName}}</ion-col>
            </ion-row>
            <ion-row>
              <ion-col style="padding-top: 0;color: white;padding-bottom: 0;margin-bottom: 20px;">
                Join Date: From <strong>{{firstPicker.value | date:'dd MMM yyyy' }}</strong> to
                <strong>{{secondPicker.value | date:'dd MMM yyyy' }}</strong>
              </ion-col>
            </ion-row>
            <ion-row style="display: flex; flex-flow: row nowrap;">
              <ion-col size="0.5" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 26px;">
                No</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 175px;">
                Employee Name</ion-col>
              <ion-col size="1.5" style="text-align: left;display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 175px;">
                Company Name</ion-col>
              <ion-col size="1.2" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 125px;">
                Department</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Designation</ion-col>
              <ion-col size="1.2" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 125px;">
                Email</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Approver</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
            -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
            5px;min-width: 88px;">
                Joining Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 88px;">
                Confirmed Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 88px;">
                Resigned Date</ion-col>
              <ion-col size="1" class="titleRow" style="display: -webkit-box;
              -webkit-line-clamp: 2;-webkit-box-orient: vertical;overflow: hidden;padding-bottom: 0;margin-bottom:
              5px;min-width: 88px;">
                Status</ion-col>
            </ion-row>
          </div>

          <div class="content" style="min-width: 1500px;">
            <!-- ngFor under this div -->
            <ng-container *ngFor="let item of arrayDetails; let i=index; let odd=odd;">
              <div style="padding: 10px;" [ngClass]="{ odd: odd }">
                <ion-row style="display: flex; flex-flow: row nowrap;">
                  <ion-col size="0.5" class="titleRow text" style="min-width: 26px;">
                    {{i+1}}</ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px; white-space: pre-line;">
                    {{item.employeeName}}
                    <p class="text" style="font-weight: 600;padding-top: 10px;">ID: {{item.employeeNo}}</p>
                  </ion-col>
                  <ion-col size="1.5" class="text" style="min-width: 175px; white-space: pre-line;">
                    {{item.companyName}}
                  </ion-col>
                  <ion-col size="1.2" class="titleRow text" style="min-width: 125px; white-space: pre-line;">
                    {{item.department}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.designation}}</ion-col>
                  <ion-col size="1.2" class="titleRow text" style="min-width: 125px; white-space: pre-line;">
                    {{item.email}}</ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.approver}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.joinDate}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.confirmDate}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.resignDate}}
                  </ion-col>
                  <ion-col size="1" class="titleRow text" style="min-width: 88px; white-space: pre-line;">
                    {{item.status}}
                  </ion-col>
                </ion-row>
              </div>
            </ng-container>
          </div>
        </div>
      </ion-card-content>
    </div>
  </div>

</ion-card>