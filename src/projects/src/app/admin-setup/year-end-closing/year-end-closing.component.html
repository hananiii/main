<ion-card>
  <ion-card-header style="border-radius: 2px;box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.04);">
    <div class="fullContainer">
      <div class="left" style="min-width:fit-content;">
        <img src="assets/icon/leave_setup/icon_year_end_closing@3x.png" style="width:34px;height:33px">
      </div>
      <div class="right">
        <ion-card-subtitle style="color: #43425d;opacity: 0.8;font-weight: bold;font-size: 13px;">Year End Closing
        </ion-card-subtitle>
        <ion-card-subtitle class="subtitle" style="font-size: 12px;">
          Year End Closing is a setup to clear the leave in a current year to close account for all employee
        </ion-card-subtitle>
      </div>
    </div>
  </ion-card-header>
  <div style="width: 100%; height:100%; text-align: center; margin-top: -30px" *ngIf="showSpinner">
    <app-spinner></app-spinner>
  </div>
  <div style="background: #f0f0f7;height: 100%;position: absolute;width: 100%;">
    <div class="cardContent">
      <ion-card-content style="max-height: 100%;height: 100%;">
        <div class="row">
          <div class="list">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col style="font-size: 12px;white-space: nowrap;
                                  text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  COMPANY LIST</ion-col>
              </ion-row>
            </div>
            <div style="height: calc(100% - 62px);overflow-y: auto;margin-top: 15px;">
              <ion-row class="detailsRow" *ngFor="let item of companyName; let i=index" style="padding-left: 10px;">
                <ion-col style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;">
                  <p class="textHover" style="cursor: pointer;font-size: 12px;font-weight: bold;overflow:
                  hidden;white-space: pre-line;text-overflow: ellipsis;margin-bottom: 0;" [ngClass]="{
                      'textColor': clickedIndex === i, 'oriColor': clickedIndex !== i}"
                    (click)="clickedCompany(item, i)">
                    {{item.NAME}}
                </ion-col>
                <ion-item class="divider" lines="full">
                </ion-item>
              </ion-row>
            </div>
          </div>
          <div class="action">
            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col style="font-size: 12px;white-space: nowrap;
                                  text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  ACTION NEEDED - {{labelCompany}}
                </ion-col>
              </ion-row>
            </div>
            <div *ngIf="pendingTotal" style="margin: 15px;margin-left:10px">
              <ion-row style="display: flex; flex-wrap: wrap;">
                <ion-col align-self-center style="flex: 5.5 1 0px; min-width: 250px;">
                  <p
                    style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;opacity: 0.8;font-size:12px;">
                    Clear pending leaves. There are <strong>{{pendingTotal.length}}</strong> pending leaves. Click here
                    to take action
                  </p>
                </ion-col>
                <ion-col style="flex: 1; min-width: fit-content;">
                  <ion-button
                    style="--border-radius: 2px;font-size: 11px;height: 30px;width:165px;cursor: pointer;text-transform: none;"
                    color="primary" routerLink="/main/approval-override"> Take Action
                  </ion-button>
                </ion-col>
                <ion-col style="flex: 4; min-width: 1px;"></ion-col>
              </ion-row>
              <ion-row style="display: flex; flex-wrap: wrap;">
                <ion-col align-self-center style="flex: 5.5 1 0px; min-width: 250px;">
                  <p
                    style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;opacity: 0.8;font-size:12px;">
                    Please backup or print out the necessary report. Click here to take action</p>
                </ion-col>
                <ion-col style="flex: 1; min-width: fit-content;">
                  <ion-button
                    style="--border-radius: 2px;font-size: 11px;height: 30px;width:165px;cursor: pointer;text-transform: none;"
                    color="primary" routerLink="/main/report">
                    Take Action
                  </ion-button>
                </ion-col>
                <ion-col style="flex: 4; min-width: 1px;"></ion-col>
              </ion-row>
              <ion-row style="display: flex; flex-wrap: wrap;">
                <ion-col align-self-center style="flex: 5.5 1 0px; min-width: 250px;">
                  <p
                    style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;opacity: 0.8;font-size:12px;">
                    Update resigned staff info in the employee master list. Click here to take action</p>
                </ion-col>
                <ion-col style="flex: 1; min-width: fit-content;">
                  <ion-button
                    style="--border-radius: 2px;font-size: 11px;height: 30px;width:165px;cursor: pointer;text-transform: none;"
                    color="primary" routerLink="/main/employee-setup">
                    Take Action
                  </ion-button>
                </ion-col>
                <ion-col style="flex: 4; min-width: 1px;"></ion-col>
              </ion-row>
            </div>

            <div
              style="font-size: 12px;width:100%;background: #f5f6fa;padding: 10px;margin-bottom: 5px;color: #a3a6b4;font-weight: bold;">
              <ion-row>
                <ion-col style="font-size: 12px;white-space: nowrap;
                                text-overflow: ellipsis;overflow: hidden;padding-bottom: 0;margin-bottom: 5px;">
                  CLOSING YEAR - {{labelCompany}}</ion-col>
              </ion-row>
            </div>
            <div style="margin: 15px;margin-left:10px">
              <p style="color: #4d4f5c;font-size:12px;">Closing Year</p>
              <div style="display: flex; flex-wrap: wrap;">
                <mat-form-field appearance="outline" style="display: inline-block; min-width: 150px;
                  font-size: 12px;width: 20%;color: #43425d;opacity: 0.8;flex: 1;">
                  <mat-select [(value)]="selected" placeholder="Nothing Selected" required>
                    <mat-option *ngIf="yearList.length === 0">No closing year</mat-option>
                    <mat-option *ngFor="let item of yearList" [value]=item>
                      {{item}}
                    </mat-option>
                  </mat-select>
                  <ion-spinner name="lines-small" *ngIf="showSmallSpinner" color="primary" style="position: absolute;
                  margin-left: -50px;margin-top: -10px;"></ion-spinner>
                </mat-form-field>
                <ion-button *ngIf="pendingTotal" style="--border-radius: 2px;font-size: 11px;height: 38px;width:165px;cursor: pointer;text-transform: none;
                  margin-left: 15px; flex: 1; min-width: 150px;" color="primary" (click)="showDialog()"
                  [disabled]="pendingTotal.length !== 0 || yearList.length == 0">
                  Submit
                </ion-button>
                <div style="flex: 3"></div>
              </div>
              <ng-container *ngFor="let item of policy; let j=index">
                <p *ngIf="clickedIndex === j && item.AVAILABLE_DATE_CLOSE !== 'No closed date found'"
                  style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;opacity: 0.8;font-size:12px;">
                  Next available closing date: {{item.AVAILABLE_DATE_CLOSE | date: 'dd MMM yyyy'}}</p>
                <p *ngIf="clickedIndex === j && item.AVAILABLE_DATE_CLOSE === 'No closed date found'"
                  style="overflow: hidden;white-space: pre-line;text-overflow: ellipsis;color: #4d4f5c;opacity: 0.8;font-size:12px;">
                  Next available closing date: N/A</p>
              </ng-container>
            </div>
          </div>

        </div>
      </ion-card-content>
    </div>
  </div>
</ion-card>